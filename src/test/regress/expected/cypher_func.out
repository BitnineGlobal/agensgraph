--
-- labesl()
--
--
-- simple test
--
--
-- prepare
--
drop graph simpletest cascade;
ERROR:  graph "simpletest" does not exist
drop graph complextest1 cascade;
ERROR:  graph "complextest1" does not exist
drop graph complextest2 cascade;
ERROR:  graph "complextest2" does not exist
--
-- set graph path
--
create graph simpletest;
set graph_path=simpletest;
--
-- make vlabels
--          A
--          |
--  B       C
--  |       |
--  ----D----
--
create vlabel a;
create vlabel b;
create vlabel c inherits ( a );
create vlabel d inherits ( b , c );
--
-- make nodes
--
create (n:a {name:'nA'} ) return n;
          n           
----------------------
 a[3.1]{"name": "nA"}
(1 row)

create (n:b {name:'nB'} ) return n;
          n           
----------------------
 b[4.1]{"name": "nB"}
(1 row)

create (n:c {name:'nC'} ) return n;
          n           
----------------------
 c[5.1]{"name": "nC"}
(1 row)

create (n:d {name:'nD'} ) return n;
          n           
----------------------
 d[6.1]{"name": "nD"}
(1 row)

--
-- label()
--
match (x:a) return x.name, label(x);
 name | label 
------+-------
 "nA" | "a"
 "nC" | "c"
 "nD" | "d"
(3 rows)

match (x:b) return x.name, label(x);
 name | label 
------+-------
 "nB" | "b"
 "nD" | "d"
(2 rows)

match (x:c) return x.name, label(x);
 name | label 
------+-------
 "nC" | "c"
 "nD" | "d"
(2 rows)

match (x:d) return x.name, label(x);
 name | label 
------+-------
 "nD" | "d"
(1 row)

--
-- lables()
--
match (x:a) return x.name, labels(x);
 name |        labels        
------+----------------------
 "nA" | ["a"]
 "nC" | ["c", "a"]
 "nD" | ["d", "b", "c", "a"]
(3 rows)

match (x:b) return x.name, labels(x);
 name |        labels        
------+----------------------
 "nB" | ["b"]
 "nD" | ["d", "b", "c", "a"]
(2 rows)

match (x:c) return x.name, labels(x);
 name |        labels        
------+----------------------
 "nC" | ["c", "a"]
 "nD" | ["d", "b", "c", "a"]
(2 rows)

match (x:d) return x.name, labels(x);
 name |        labels        
------+----------------------
 "nD" | ["d", "b", "c", "a"]
(1 row)

match (x:a) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nA" | "a"
 "nC" | "c"
 "nD" | "d"
(3 rows)

match (x:b) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nB" | "b"
 "nD" | "d"
(2 rows)

match (x:c) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nC" | "c"
 "nD" | "d"
(2 rows)

match (x:d) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nD" | "d"
(1 row)

match (x:a) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nA" | 
 "nC" | "a"
 "nD" | "b"
(3 rows)

match (x:b) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nB" | 
 "nD" | "b"
(2 rows)

match (x:c) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nC" | "a"
 "nD" | "b"
(2 rows)

match (x:d) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nD" | "b"
(1 row)

match (x:a) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | "c"
(3 rows)

match (x:b) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nB" | 
 "nD" | "c"
(2 rows)

match (x:c) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nC" | 
 "nD" | "c"
(2 rows)

match (x:d) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nD" | "c"
(1 row)

--
-- complex test 1
--
--
-- set graph path
--
create graph complextest1;
set graph_path=complextest1;
--
-- make vlabels
--                     A
--                     |
--                     B       C
--                     |       |
-- --------D--------   ----E----   F   ----G
-- |       |       |       |       |   |   |
-- H       I       J       --------K----   |
--         |       |               |       |
--         ----------------L----------------
--
create vlabel a;
create vlabel b inherits( a );
create vlabel c;
create vlabel d;
create vlabel e inherits( b , c );
create vlabel f;
create vlabel g;
create vlabel h inherits( d );
create vlabel i inherits( d );
create vlabel j inherits( d );
create vlabel k inherits( e , f , g );
create vlabel l inherits( i , j , k , g );
--
-- make nodes
--
create (n:a {name:'nA'} ) return n;
          n           
----------------------
 a[3.1]{"name": "nA"}
(1 row)

create (n:b {name:'nB'} ) return n;
          n           
----------------------
 b[4.1]{"name": "nB"}
(1 row)

create (n:c {name:'nC'} ) return n;
          n           
----------------------
 c[5.1]{"name": "nC"}
(1 row)

create (n:d {name:'nD'} ) return n;
          n           
----------------------
 d[6.1]{"name": "nD"}
(1 row)

create (n:e {name:'nE'} ) return n;
          n           
----------------------
 e[7.1]{"name": "nE"}
(1 row)

create (n:f {name:'nF'} ) return n;
          n           
----------------------
 f[8.1]{"name": "nF"}
(1 row)

create (n:g {name:'nG'} ) return n;
          n           
----------------------
 g[9.1]{"name": "nG"}
(1 row)

create (n:h {name:'nH'} ) return n;
           n           
-----------------------
 h[10.1]{"name": "nH"}
(1 row)

create (n:i {name:'nI'} ) return n;
           n           
-----------------------
 i[11.1]{"name": "nI"}
(1 row)

create (n:j {name:'nJ'} ) return n;
           n           
-----------------------
 j[12.1]{"name": "nJ"}
(1 row)

create (n:k {name:'nK'} ) return n;
           n           
-----------------------
 k[13.1]{"name": "nK"}
(1 row)

create (n:l {name:'nL'} ) return n;
           n           
-----------------------
 l[14.1]{"name": "nL"}
(1 row)

--
-- label()
--
match (x:a) return x.name, label(x);
 name | label 
------+-------
 "nA" | "a"
 "nB" | "b"
 "nE" | "e"
 "nK" | "k"
 "nL" | "l"
(5 rows)

match (x:b) return x.name, label(x);
 name | label 
------+-------
 "nB" | "b"
 "nE" | "e"
 "nK" | "k"
 "nL" | "l"
(4 rows)

match (x:c) return x.name, label(x);
 name | label 
------+-------
 "nC" | "c"
 "nE" | "e"
 "nK" | "k"
 "nL" | "l"
(4 rows)

match (x:d) return x.name, label(x);
 name | label 
------+-------
 "nD" | "d"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
 "nL" | "l"
(5 rows)

match (x:e) return x.name, label(x);
 name | label 
------+-------
 "nE" | "e"
 "nK" | "k"
 "nL" | "l"
(3 rows)

match (x:f) return x.name, label(x);
 name | label 
------+-------
 "nF" | "f"
 "nK" | "k"
 "nL" | "l"
(3 rows)

match (x:g) return x.name, label(x);
 name | label 
------+-------
 "nG" | "g"
 "nK" | "k"
 "nL" | "l"
(3 rows)

match (x:h) return x.name, label(x);
 name | label 
------+-------
 "nH" | "h"
(1 row)

match (x:i) return x.name, label(x);
 name | label 
------+-------
 "nI" | "i"
 "nL" | "l"
(2 rows)

match (x:j) return x.name, label(x);
 name | label 
------+-------
 "nJ" | "j"
 "nL" | "l"
(2 rows)

match (x:k) return x.name, label(x);
 name | label 
------+-------
 "nK" | "k"
 "nL" | "l"
(2 rows)

match (x:l) return x.name, label(x);
 name | label 
------+-------
 "nL" | "l"
(1 row)

--
-- labels()
--
match (x:a) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nA" | ["a"]
 "nB" | ["b", "a"]
 "nE" | ["e", "b", "c", "a"]
 "nK" | ["k", "e", "f", "g", "b", "c", "a"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(5 rows)

match (x:b) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nB" | ["b", "a"]
 "nE" | ["e", "b", "c", "a"]
 "nK" | ["k", "e", "f", "g", "b", "c", "a"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(4 rows)

match (x:c) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nC" | ["c"]
 "nE" | ["e", "b", "c", "a"]
 "nK" | ["k", "e", "f", "g", "b", "c", "a"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(4 rows)

match (x:d) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nD" | ["d"]
 "nH" | ["h", "d"]
 "nI" | ["i", "d"]
 "nJ" | ["j", "d"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(5 rows)

match (x:e) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nE" | ["e", "b", "c", "a"]
 "nK" | ["k", "e", "f", "g", "b", "c", "a"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(3 rows)

match (x:f) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nF" | ["f"]
 "nK" | ["k", "e", "f", "g", "b", "c", "a"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(3 rows)

match (x:g) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nG" | ["g"]
 "nK" | ["k", "e", "f", "g", "b", "c", "a"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(3 rows)

match (x:h) return x.name, labels(x);
 name |   labels   
------+------------
 "nH" | ["h", "d"]
(1 row)

match (x:i) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nI" | ["i", "d"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(2 rows)

match (x:j) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nJ" | ["j", "d"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(2 rows)

match (x:k) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nK" | ["k", "e", "f", "g", "b", "c", "a"]
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(2 rows)

match (x:l) return x.name, labels(x);
 name |                         labels                          
------+---------------------------------------------------------
 "nL" | ["l", "g", "i", "j", "k", "d", "e", "f", "b", "c", "a"]
(1 row)

match (x:a) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nA" | "a"
 "nB" | "b"
 "nE" | "e"
 "nK" | "k"
 "nL" | "l"
(5 rows)

match (x:b) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nB" | "b"
 "nE" | "e"
 "nK" | "k"
 "nL" | "l"
(4 rows)

match (x:c) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nC" | "c"
 "nE" | "e"
 "nK" | "k"
 "nL" | "l"
(4 rows)

match (x:d) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nD" | "d"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
 "nL" | "l"
(5 rows)

match (x:e) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nE" | "e"
 "nK" | "k"
 "nL" | "l"
(3 rows)

match (x:f) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nF" | "f"
 "nK" | "k"
 "nL" | "l"
(3 rows)

match (x:g) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nG" | "g"
 "nK" | "k"
 "nL" | "l"
(3 rows)

match (x:h) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nH" | "h"
(1 row)

match (x:i) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nI" | "i"
 "nL" | "l"
(2 rows)

match (x:j) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nJ" | "j"
 "nL" | "l"
(2 rows)

match (x:k) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nK" | "k"
 "nL" | "l"
(2 rows)

match (x:l) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nL" | "l"
(1 row)

match (x:a) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nA" | 
 "nB" | "a"
 "nE" | "b"
 "nK" | "e"
 "nL" | "g"
(5 rows)

match (x:b) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nB" | "a"
 "nE" | "b"
 "nK" | "e"
 "nL" | "g"
(4 rows)

match (x:c) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nC" | 
 "nE" | "b"
 "nK" | "e"
 "nL" | "g"
(4 rows)

match (x:d) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nD" | 
 "nH" | "d"
 "nI" | "d"
 "nJ" | "d"
 "nL" | "g"
(5 rows)

match (x:e) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nE" | "b"
 "nK" | "e"
 "nL" | "g"
(3 rows)

match (x:f) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nF" | 
 "nK" | "e"
 "nL" | "g"
(3 rows)

match (x:g) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nG" | 
 "nK" | "e"
 "nL" | "g"
(3 rows)

match (x:h) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nH" | "d"
(1 row)

match (x:i) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nI" | "d"
 "nL" | "g"
(2 rows)

match (x:j) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nJ" | "d"
 "nL" | "g"
(2 rows)

match (x:k) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nK" | "e"
 "nL" | "g"
(2 rows)

match (x:l) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nL" | "g"
(1 row)

match (x:a) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | "c"
 "nK" | "f"
 "nL" | "i"
(5 rows)

match (x:b) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nB" | 
 "nE" | "c"
 "nK" | "f"
 "nL" | "i"
(4 rows)

match (x:c) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nC" | 
 "nE" | "c"
 "nK" | "f"
 "nL" | "i"
(4 rows)

match (x:d) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "i"
(5 rows)

match (x:e) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nE" | "c"
 "nK" | "f"
 "nL" | "i"
(3 rows)

match (x:f) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nF" | 
 "nK" | "f"
 "nL" | "i"
(3 rows)

match (x:g) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nG" | 
 "nK" | "f"
 "nL" | "i"
(3 rows)

match (x:h) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nI" | 
 "nL" | "i"
(2 rows)

match (x:j) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "i"
(2 rows)

match (x:k) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nK" | "f"
 "nL" | "i"
(2 rows)

match (x:l) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nL" | "i"
(1 row)

match (x:a) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | "a"
 "nK" | "g"
 "nL" | "j"
(5 rows)

match (x:b) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nB" | 
 "nE" | "a"
 "nK" | "g"
 "nL" | "j"
(4 rows)

match (x:c) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nC" | 
 "nE" | "a"
 "nK" | "g"
 "nL" | "j"
(4 rows)

match (x:d) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "j"
(5 rows)

match (x:e) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nE" | "a"
 "nK" | "g"
 "nL" | "j"
(3 rows)

match (x:f) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nF" | 
 "nK" | "g"
 "nL" | "j"
(3 rows)

match (x:g) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nG" | 
 "nK" | "g"
 "nL" | "j"
(3 rows)

match (x:h) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nI" | 
 "nL" | "j"
(2 rows)

match (x:j) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "j"
(2 rows)

match (x:k) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nK" | "g"
 "nL" | "j"
(2 rows)

match (x:l) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nL" | "j"
(1 row)

match (x:a) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | 
 "nK" | "b"
 "nL" | "k"
(5 rows)

match (x:b) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nB" | 
 "nE" | 
 "nK" | "b"
 "nL" | "k"
(4 rows)

match (x:c) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nC" | 
 "nE" | 
 "nK" | "b"
 "nL" | "k"
(4 rows)

match (x:d) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "k"
(5 rows)

match (x:e) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nE" | 
 "nK" | "b"
 "nL" | "k"
(3 rows)

match (x:f) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nF" | 
 "nK" | "b"
 "nL" | "k"
(3 rows)

match (x:g) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nG" | 
 "nK" | "b"
 "nL" | "k"
(3 rows)

match (x:h) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nI" | 
 "nL" | "k"
(2 rows)

match (x:j) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "k"
(2 rows)

match (x:k) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nK" | "b"
 "nL" | "k"
(2 rows)

match (x:l) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nL" | "k"
(1 row)

match (x:a) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | 
 "nK" | "c"
 "nL" | "d"
(5 rows)

match (x:b) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nB" | 
 "nE" | 
 "nK" | "c"
 "nL" | "d"
(4 rows)

match (x:c) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nC" | 
 "nE" | 
 "nK" | "c"
 "nL" | "d"
(4 rows)

match (x:d) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "d"
(5 rows)

match (x:e) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nE" | 
 "nK" | "c"
 "nL" | "d"
(3 rows)

match (x:f) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nF" | 
 "nK" | "c"
 "nL" | "d"
(3 rows)

match (x:g) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nG" | 
 "nK" | "c"
 "nL" | "d"
(3 rows)

match (x:h) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nI" | 
 "nL" | "d"
(2 rows)

match (x:j) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "d"
(2 rows)

match (x:k) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nK" | "c"
 "nL" | "d"
(2 rows)

match (x:l) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nL" | "d"
(1 row)

match (x:a) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | 
 "nK" | "a"
 "nL" | "e"
(5 rows)

match (x:b) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nB" | 
 "nE" | 
 "nK" | "a"
 "nL" | "e"
(4 rows)

match (x:c) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nC" | 
 "nE" | 
 "nK" | "a"
 "nL" | "e"
(4 rows)

match (x:d) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "e"
(5 rows)

match (x:e) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nE" | 
 "nK" | "a"
 "nL" | "e"
(3 rows)

match (x:f) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nF" | 
 "nK" | "a"
 "nL" | "e"
(3 rows)

match (x:g) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nG" | 
 "nK" | "a"
 "nL" | "e"
(3 rows)

match (x:h) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nI" | 
 "nL" | "e"
(2 rows)

match (x:j) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "e"
(2 rows)

match (x:k) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nK" | "a"
 "nL" | "e"
(2 rows)

match (x:l) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nL" | "e"
(1 row)

match (x:a) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | 
 "nK" | 
 "nL" | "f"
(5 rows)

match (x:b) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nB" | 
 "nE" | 
 "nK" | 
 "nL" | "f"
(4 rows)

match (x:c) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nC" | 
 "nE" | 
 "nK" | 
 "nL" | "f"
(4 rows)

match (x:d) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "f"
(5 rows)

match (x:e) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nE" | 
 "nK" | 
 "nL" | "f"
(3 rows)

match (x:f) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nF" | 
 "nK" | 
 "nL" | "f"
(3 rows)

match (x:g) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nG" | 
 "nK" | 
 "nL" | "f"
(3 rows)

match (x:h) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nI" | 
 "nL" | "f"
(2 rows)

match (x:j) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "f"
(2 rows)

match (x:k) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nK" | 
 "nL" | "f"
(2 rows)

match (x:l) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nL" | "f"
(1 row)

match (x:a) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | 
 "nK" | 
 "nL" | "b"
(5 rows)

match (x:b) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nB" | 
 "nE" | 
 "nK" | 
 "nL" | "b"
(4 rows)

match (x:c) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nC" | 
 "nE" | 
 "nK" | 
 "nL" | "b"
(4 rows)

match (x:d) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "b"
(5 rows)

match (x:e) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nE" | 
 "nK" | 
 "nL" | "b"
(3 rows)

match (x:f) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nF" | 
 "nK" | 
 "nL" | "b"
(3 rows)

match (x:g) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nG" | 
 "nK" | 
 "nL" | "b"
(3 rows)

match (x:h) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nI" | 
 "nL" | "b"
(2 rows)

match (x:j) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "b"
(2 rows)

match (x:k) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nK" | 
 "nL" | "b"
(2 rows)

match (x:l) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nL" | "b"
(1 row)

match (x:a) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | 
 "nK" | 
 "nL" | "c"
(5 rows)

match (x:b) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nB" | 
 "nE" | 
 "nK" | 
 "nL" | "c"
(4 rows)

match (x:c) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nC" | 
 "nE" | 
 "nK" | 
 "nL" | "c"
(4 rows)

match (x:d) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "c"
(5 rows)

match (x:e) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nE" | 
 "nK" | 
 "nL" | "c"
(3 rows)

match (x:f) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nF" | 
 "nK" | 
 "nL" | "c"
(3 rows)

match (x:g) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nG" | 
 "nK" | 
 "nL" | "c"
(3 rows)

match (x:h) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nI" | 
 "nL" | "c"
(2 rows)

match (x:j) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "c"
(2 rows)

match (x:k) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nK" | 
 "nL" | "c"
(2 rows)

match (x:l) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nL" | "c"
(1 row)

match (x:a) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nA" | 
 "nB" | 
 "nE" | 
 "nK" | 
 "nL" | "a"
(5 rows)

match (x:b) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nB" | 
 "nE" | 
 "nK" | 
 "nL" | "a"
(4 rows)

match (x:c) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nC" | 
 "nE" | 
 "nK" | 
 "nL" | "a"
(4 rows)

match (x:d) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nD" | 
 "nH" | 
 "nI" | 
 "nJ" | 
 "nL" | "a"
(5 rows)

match (x:e) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nE" | 
 "nK" | 
 "nL" | "a"
(3 rows)

match (x:f) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nF" | 
 "nK" | 
 "nL" | "a"
(3 rows)

match (x:g) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nG" | 
 "nK" | 
 "nL" | "a"
(3 rows)

match (x:h) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nH" | 
(1 row)

match (x:i) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nI" | 
 "nL" | "a"
(2 rows)

match (x:j) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nJ" | 
 "nL" | "a"
(2 rows)

match (x:k) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nK" | 
 "nL" | "a"
(2 rows)

match (x:l) return x.name, labels(x)[10];
 name | labels 
------+--------
 "nL" | "a"
(1 row)

--
-- complex test 2 
--
--
-- set graph path
--
create graph complextest2;
set graph_path=complextest2;
--
-- make vlabels
-- ----A------------
-- |   |       B   |
-- |   |       |   |
-- |   ----D----   |
-- |       |       |
-- |       E--   --F
-- |         |   |
-- ----C     --G--
--     |      | |
--     ----H--- ---I
--         |       | 
--         ----J----
--
create vlabel a;
create vlabel b;
create vlabel c inherits( a );
create vlabel d inherits( a , b );
create vlabel e inherits( d );
create vlabel f inherits( a );
create vlabel g inherits( e , f );
create vlabel h inherits( c , g );
create vlabel i inherits( g );
create vlabel j inherits( h , i );
--
-- make nodes
--
create (n:a {name:'nA'} ) return n;
          n           
----------------------
 a[3.1]{"name": "nA"}
(1 row)

create (n:b {name:'nB'} ) return n;
          n           
----------------------
 b[4.1]{"name": "nB"}
(1 row)

create (n:c {name:'nC'} ) return n;
          n           
----------------------
 c[5.1]{"name": "nC"}
(1 row)

create (n:d {name:'nD'} ) return n;
          n           
----------------------
 d[6.1]{"name": "nD"}
(1 row)

create (n:e {name:'nE'} ) return n;
          n           
----------------------
 e[7.1]{"name": "nE"}
(1 row)

create (n:f {name:'nF'} ) return n;
          n           
----------------------
 f[8.1]{"name": "nF"}
(1 row)

create (n:g {name:'nG'} ) return n;
          n           
----------------------
 g[9.1]{"name": "nG"}
(1 row)

create (n:h {name:'nH'} ) return n;
           n           
-----------------------
 h[10.1]{"name": "nH"}
(1 row)

create (n:i {name:'nI'} ) return n;
           n           
-----------------------
 i[11.1]{"name": "nI"}
(1 row)

create (n:j {name:'nJ'} ) return n;
           n           
-----------------------
 j[12.1]{"name": "nJ"}
(1 row)

--
-- label()
--
match (x:a) return x.name, label(x);
 name | label 
------+-------
 "nA" | "a"
 "nC" | "c"
 "nD" | "d"
 "nF" | "f"
 "nH" | "h"
 "nE" | "e"
 "nG" | "g"
 "nJ" | "j"
 "nI" | "i"
(9 rows)

match (x:b) return x.name, label(x);
 name | label 
------+-------
 "nB" | "b"
 "nD" | "d"
 "nE" | "e"
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(7 rows)

match (x:c) return x.name, label(x);
 name | label 
------+-------
 "nC" | "c"
 "nH" | "h"
 "nJ" | "j"
(3 rows)

match (x:d) return x.name, label(x);
 name | label 
------+-------
 "nD" | "d"
 "nE" | "e"
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(6 rows)

match (x:e) return x.name, label(x);
 name | label 
------+-------
 "nE" | "e"
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(5 rows)

match (x:f) return x.name, label(x);
 name | label 
------+-------
 "nF" | "f"
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(5 rows)

match (x:g) return x.name, label(x);
 name | label 
------+-------
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(4 rows)

match (x:h) return x.name, label(x);
 name | label 
------+-------
 "nH" | "h"
 "nJ" | "j"
(2 rows)

match (x:i) return x.name, label(x);
 name | label 
------+-------
 "nI" | "i"
 "nJ" | "j"
(2 rows)

match (x:j) return x.name, label(x);
 name | label 
------+-------
 "nJ" | "j"
(1 row)

--
-- labels()
--
match (x:a) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nA" | ["a"]
 "nC" | ["c", "a"]
 "nD" | ["d", "a", "b"]
 "nF" | ["f", "a"]
 "nH" | ["h", "c", "g", "a", "e", "f", "d", "b"]
 "nE" | ["e", "d", "a", "b"]
 "nG" | ["g", "e", "f", "d", "a", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
 "nI" | ["i", "g", "e", "f", "d", "a", "b"]
(9 rows)

match (x:b) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nB" | ["b"]
 "nD" | ["d", "a", "b"]
 "nE" | ["e", "d", "a", "b"]
 "nG" | ["g", "e", "f", "d", "a", "b"]
 "nH" | ["h", "c", "g", "a", "e", "f", "d", "b"]
 "nI" | ["i", "g", "e", "f", "d", "a", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(7 rows)

match (x:c) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nC" | ["c", "a"]
 "nH" | ["h", "c", "g", "a", "e", "f", "d", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(3 rows)

match (x:d) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nD" | ["d", "a", "b"]
 "nE" | ["e", "d", "a", "b"]
 "nG" | ["g", "e", "f", "d", "a", "b"]
 "nH" | ["h", "c", "g", "a", "e", "f", "d", "b"]
 "nI" | ["i", "g", "e", "f", "d", "a", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(6 rows)

match (x:e) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nE" | ["e", "d", "a", "b"]
 "nG" | ["g", "e", "f", "d", "a", "b"]
 "nH" | ["h", "c", "g", "a", "e", "f", "d", "b"]
 "nI" | ["i", "g", "e", "f", "d", "a", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(5 rows)

match (x:f) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nF" | ["f", "a"]
 "nG" | ["g", "e", "f", "d", "a", "b"]
 "nH" | ["h", "c", "g", "a", "e", "f", "d", "b"]
 "nI" | ["i", "g", "e", "f", "d", "a", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(5 rows)

match (x:g) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nG" | ["g", "e", "f", "d", "a", "b"]
 "nH" | ["h", "c", "g", "a", "e", "f", "d", "b"]
 "nI" | ["i", "g", "e", "f", "d", "a", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(4 rows)

match (x:h) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nH" | ["h", "c", "g", "a", "e", "f", "d", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(2 rows)

match (x:i) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nI" | ["i", "g", "e", "f", "d", "a", "b"]
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(2 rows)

match (x:j) return x.name, labels(x);
 name |                       labels                       
------+----------------------------------------------------
 "nJ" | ["j", "h", "i", "c", "g", "a", "e", "f", "d", "b"]
(1 row)

match (x:a) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nA" | "a"
 "nC" | "c"
 "nD" | "d"
 "nF" | "f"
 "nH" | "h"
 "nE" | "e"
 "nG" | "g"
 "nJ" | "j"
 "nI" | "i"
(9 rows)

match (x:b) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nB" | "b"
 "nD" | "d"
 "nE" | "e"
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(7 rows)

match (x:c) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nC" | "c"
 "nH" | "h"
 "nJ" | "j"
(3 rows)

match (x:d) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nD" | "d"
 "nE" | "e"
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(6 rows)

match (x:e) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nE" | "e"
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(5 rows)

match (x:f) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nF" | "f"
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(5 rows)

match (x:g) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nG" | "g"
 "nH" | "h"
 "nI" | "i"
 "nJ" | "j"
(4 rows)

match (x:h) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nH" | "h"
 "nJ" | "j"
(2 rows)

match (x:i) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nI" | "i"
 "nJ" | "j"
(2 rows)

match (x:j) return x.name, labels(x)[0];
 name | labels 
------+--------
 "nJ" | "j"
(1 row)

match (x:a) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nA" | 
 "nC" | "a"
 "nD" | "a"
 "nF" | "a"
 "nH" | "c"
 "nE" | "d"
 "nG" | "e"
 "nJ" | "h"
 "nI" | "g"
(9 rows)

match (x:b) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nB" | 
 "nD" | "a"
 "nE" | "d"
 "nG" | "e"
 "nH" | "c"
 "nI" | "g"
 "nJ" | "h"
(7 rows)

match (x:c) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nC" | "a"
 "nH" | "c"
 "nJ" | "h"
(3 rows)

match (x:d) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nD" | "a"
 "nE" | "d"
 "nG" | "e"
 "nH" | "c"
 "nI" | "g"
 "nJ" | "h"
(6 rows)

match (x:e) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nE" | "d"
 "nG" | "e"
 "nH" | "c"
 "nI" | "g"
 "nJ" | "h"
(5 rows)

match (x:f) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nF" | "a"
 "nG" | "e"
 "nH" | "c"
 "nI" | "g"
 "nJ" | "h"
(5 rows)

match (x:g) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nG" | "e"
 "nH" | "c"
 "nI" | "g"
 "nJ" | "h"
(4 rows)

match (x:h) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nH" | "c"
 "nJ" | "h"
(2 rows)

match (x:i) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nI" | "g"
 "nJ" | "h"
(2 rows)

match (x:j) return x.name, labels(x)[1];
 name | labels 
------+--------
 "nJ" | "h"
(1 row)

match (x:a) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | "b"
 "nF" | 
 "nH" | "g"
 "nE" | "a"
 "nG" | "f"
 "nJ" | "i"
 "nI" | "e"
(9 rows)

match (x:b) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nB" | 
 "nD" | "b"
 "nE" | "a"
 "nG" | "f"
 "nH" | "g"
 "nI" | "e"
 "nJ" | "i"
(7 rows)

match (x:c) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nC" | 
 "nH" | "g"
 "nJ" | "i"
(3 rows)

match (x:d) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nD" | "b"
 "nE" | "a"
 "nG" | "f"
 "nH" | "g"
 "nI" | "e"
 "nJ" | "i"
(6 rows)

match (x:e) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nE" | "a"
 "nG" | "f"
 "nH" | "g"
 "nI" | "e"
 "nJ" | "i"
(5 rows)

match (x:f) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nF" | 
 "nG" | "f"
 "nH" | "g"
 "nI" | "e"
 "nJ" | "i"
(5 rows)

match (x:g) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nG" | "f"
 "nH" | "g"
 "nI" | "e"
 "nJ" | "i"
(4 rows)

match (x:h) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nH" | "g"
 "nJ" | "i"
(2 rows)

match (x:i) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nI" | "e"
 "nJ" | "i"
(2 rows)

match (x:j) return x.name, labels(x)[2];
 name | labels 
------+--------
 "nJ" | "i"
(1 row)

match (x:a) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | 
 "nF" | 
 "nH" | "a"
 "nE" | "b"
 "nG" | "d"
 "nJ" | "c"
 "nI" | "f"
(9 rows)

match (x:b) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nB" | 
 "nD" | 
 "nE" | "b"
 "nG" | "d"
 "nH" | "a"
 "nI" | "f"
 "nJ" | "c"
(7 rows)

match (x:c) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nC" | 
 "nH" | "a"
 "nJ" | "c"
(3 rows)

match (x:d) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nD" | 
 "nE" | "b"
 "nG" | "d"
 "nH" | "a"
 "nI" | "f"
 "nJ" | "c"
(6 rows)

match (x:e) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nE" | "b"
 "nG" | "d"
 "nH" | "a"
 "nI" | "f"
 "nJ" | "c"
(5 rows)

match (x:f) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nF" | 
 "nG" | "d"
 "nH" | "a"
 "nI" | "f"
 "nJ" | "c"
(5 rows)

match (x:g) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nG" | "d"
 "nH" | "a"
 "nI" | "f"
 "nJ" | "c"
(4 rows)

match (x:h) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nH" | "a"
 "nJ" | "c"
(2 rows)

match (x:i) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nI" | "f"
 "nJ" | "c"
(2 rows)

match (x:j) return x.name, labels(x)[3];
 name | labels 
------+--------
 "nJ" | "c"
(1 row)

match (x:a) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | 
 "nF" | 
 "nH" | "e"
 "nE" | 
 "nG" | "a"
 "nJ" | "g"
 "nI" | "d"
(9 rows)

match (x:b) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nB" | 
 "nD" | 
 "nE" | 
 "nG" | "a"
 "nH" | "e"
 "nI" | "d"
 "nJ" | "g"
(7 rows)

match (x:c) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nC" | 
 "nH" | "e"
 "nJ" | "g"
(3 rows)

match (x:d) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nD" | 
 "nE" | 
 "nG" | "a"
 "nH" | "e"
 "nI" | "d"
 "nJ" | "g"
(6 rows)

match (x:e) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nE" | 
 "nG" | "a"
 "nH" | "e"
 "nI" | "d"
 "nJ" | "g"
(5 rows)

match (x:f) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nF" | 
 "nG" | "a"
 "nH" | "e"
 "nI" | "d"
 "nJ" | "g"
(5 rows)

match (x:g) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nG" | "a"
 "nH" | "e"
 "nI" | "d"
 "nJ" | "g"
(4 rows)

match (x:h) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nH" | "e"
 "nJ" | "g"
(2 rows)

match (x:i) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nI" | "d"
 "nJ" | "g"
(2 rows)

match (x:j) return x.name, labels(x)[4];
 name | labels 
------+--------
 "nJ" | "g"
(1 row)

match (x:a) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | 
 "nF" | 
 "nH" | "f"
 "nE" | 
 "nG" | "b"
 "nJ" | "a"
 "nI" | "a"
(9 rows)

match (x:b) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nB" | 
 "nD" | 
 "nE" | 
 "nG" | "b"
 "nH" | "f"
 "nI" | "a"
 "nJ" | "a"
(7 rows)

match (x:c) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nC" | 
 "nH" | "f"
 "nJ" | "a"
(3 rows)

match (x:d) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nD" | 
 "nE" | 
 "nG" | "b"
 "nH" | "f"
 "nI" | "a"
 "nJ" | "a"
(6 rows)

match (x:e) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nE" | 
 "nG" | "b"
 "nH" | "f"
 "nI" | "a"
 "nJ" | "a"
(5 rows)

match (x:f) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nF" | 
 "nG" | "b"
 "nH" | "f"
 "nI" | "a"
 "nJ" | "a"
(5 rows)

match (x:g) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nG" | "b"
 "nH" | "f"
 "nI" | "a"
 "nJ" | "a"
(4 rows)

match (x:h) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nH" | "f"
 "nJ" | "a"
(2 rows)

match (x:i) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nI" | "a"
 "nJ" | "a"
(2 rows)

match (x:j) return x.name, labels(x)[5];
 name | labels 
------+--------
 "nJ" | "a"
(1 row)

match (x:a) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | 
 "nF" | 
 "nH" | "d"
 "nE" | 
 "nG" | 
 "nJ" | "e"
 "nI" | "b"
(9 rows)

match (x:b) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nB" | 
 "nD" | 
 "nE" | 
 "nG" | 
 "nH" | "d"
 "nI" | "b"
 "nJ" | "e"
(7 rows)

match (x:c) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nC" | 
 "nH" | "d"
 "nJ" | "e"
(3 rows)

match (x:d) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nD" | 
 "nE" | 
 "nG" | 
 "nH" | "d"
 "nI" | "b"
 "nJ" | "e"
(6 rows)

match (x:e) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nE" | 
 "nG" | 
 "nH" | "d"
 "nI" | "b"
 "nJ" | "e"
(5 rows)

match (x:f) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nF" | 
 "nG" | 
 "nH" | "d"
 "nI" | "b"
 "nJ" | "e"
(5 rows)

match (x:g) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nG" | 
 "nH" | "d"
 "nI" | "b"
 "nJ" | "e"
(4 rows)

match (x:h) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nH" | "d"
 "nJ" | "e"
(2 rows)

match (x:i) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nI" | "b"
 "nJ" | "e"
(2 rows)

match (x:j) return x.name, labels(x)[6];
 name | labels 
------+--------
 "nJ" | "e"
(1 row)

match (x:a) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | 
 "nF" | 
 "nH" | "b"
 "nE" | 
 "nG" | 
 "nJ" | "f"
 "nI" | 
(9 rows)

match (x:b) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nB" | 
 "nD" | 
 "nE" | 
 "nG" | 
 "nH" | "b"
 "nI" | 
 "nJ" | "f"
(7 rows)

match (x:c) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nC" | 
 "nH" | "b"
 "nJ" | "f"
(3 rows)

match (x:d) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nD" | 
 "nE" | 
 "nG" | 
 "nH" | "b"
 "nI" | 
 "nJ" | "f"
(6 rows)

match (x:e) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nE" | 
 "nG" | 
 "nH" | "b"
 "nI" | 
 "nJ" | "f"
(5 rows)

match (x:f) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nF" | 
 "nG" | 
 "nH" | "b"
 "nI" | 
 "nJ" | "f"
(5 rows)

match (x:g) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nG" | 
 "nH" | "b"
 "nI" | 
 "nJ" | "f"
(4 rows)

match (x:h) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nH" | "b"
 "nJ" | "f"
(2 rows)

match (x:i) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nI" | 
 "nJ" | "f"
(2 rows)

match (x:j) return x.name, labels(x)[7];
 name | labels 
------+--------
 "nJ" | "f"
(1 row)

match (x:a) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | 
 "nF" | 
 "nH" | 
 "nE" | 
 "nG" | 
 "nJ" | "d"
 "nI" | 
(9 rows)

match (x:b) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nB" | 
 "nD" | 
 "nE" | 
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "d"
(7 rows)

match (x:c) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nC" | 
 "nH" | 
 "nJ" | "d"
(3 rows)

match (x:d) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nD" | 
 "nE" | 
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "d"
(6 rows)

match (x:e) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nE" | 
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "d"
(5 rows)

match (x:f) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nF" | 
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "d"
(5 rows)

match (x:g) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "d"
(4 rows)

match (x:h) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nH" | 
 "nJ" | "d"
(2 rows)

match (x:i) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nI" | 
 "nJ" | "d"
(2 rows)

match (x:j) return x.name, labels(x)[8];
 name | labels 
------+--------
 "nJ" | "d"
(1 row)

match (x:a) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nA" | 
 "nC" | 
 "nD" | 
 "nF" | 
 "nH" | 
 "nE" | 
 "nG" | 
 "nJ" | "b"
 "nI" | 
(9 rows)

match (x:b) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nB" | 
 "nD" | 
 "nE" | 
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "b"
(7 rows)

match (x:c) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nC" | 
 "nH" | 
 "nJ" | "b"
(3 rows)

match (x:d) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nD" | 
 "nE" | 
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "b"
(6 rows)

match (x:e) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nE" | 
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "b"
(5 rows)

match (x:f) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nF" | 
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "b"
(5 rows)

match (x:g) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nG" | 
 "nH" | 
 "nI" | 
 "nJ" | "b"
(4 rows)

match (x:h) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nH" | 
 "nJ" | "b"
(2 rows)

match (x:i) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nI" | 
 "nJ" | "b"
(2 rows)

match (x:j) return x.name, labels(x)[9];
 name | labels 
------+--------
 "nJ" | "b"
(1 row)

--
-- cleanup
--
drop graph complextest2 cascade;
NOTICE:  drop cascades to 13 other objects
DETAIL:  drop cascades to sequence complextest2.ag_label_seq
drop cascades to label ag_vertex
drop cascades to label ag_edge
drop cascades to label a
drop cascades to label b
drop cascades to label c
drop cascades to label d
drop cascades to label e
drop cascades to label f
drop cascades to label g
drop cascades to label h
drop cascades to label i
drop cascades to label j
drop graph complextest1 cascade;
NOTICE:  drop cascades to 15 other objects
DETAIL:  drop cascades to sequence complextest1.ag_label_seq
drop cascades to label ag_vertex
drop cascades to label ag_edge
drop cascades to label a
drop cascades to label b
drop cascades to label c
drop cascades to label d
drop cascades to label e
drop cascades to label f
drop cascades to label g
drop cascades to label h
drop cascades to label i
drop cascades to label j
drop cascades to label k
drop cascades to label l
drop graph simpletest cascade;
NOTICE:  drop cascades to 7 other objects
DETAIL:  drop cascades to sequence simpletest.ag_label_seq
drop cascades to label ag_vertex
drop cascades to label ag_edge
drop cascades to label a
drop cascades to label b
drop cascades to label c
drop cascades to label d
